<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.useso.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="算法,逆向,密码,Sha1," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="又打了几天鱼晒了几天终于干了点什么，记录一下。">
<meta property="og:type" content="article">
<meta property="og:title" content="算法识别之Sha1">
<meta property="og:url" content="http://blog.injectxx.com/2016/12/15/算法识别之Sha1/index.html">
<meta property="og:site_name" content="岁月's Blog">
<meta property="og:description" content="又打了几天鱼晒了几天终于干了点什么，记录一下。">
<meta property="og:updated_time" content="2016-12-14T16:53:39.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="算法识别之Sha1">
<meta name="twitter:description" content="又打了几天鱼晒了几天终于干了点什么，记录一下。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://blog.injectxx.com/2016/12/15/算法识别之Sha1/"/>

  <title> 算法识别之Sha1 | 岁月's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?b1d70a29b3f59b8638bc9305a50cc2f6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  <div style="display: none;">
    <script src="//s6.cnzz.com/stat.php?id=1260188451&web_id=1260188451" type="text/javascript"></script>
  </div>





  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">岁月's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">一只奋斗的猿</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-board">
          <a href="/board" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            留言板
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-neighbor">
          <a href="/neighbor" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heart"></i> <br />
            
            邻居
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                算法识别之Sha1
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-12-15T00:41:54+08:00" content="2016-12-15">
              2016-12-15
            </time>
          </span>


          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/12/15/算法识别之Sha1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/15/算法识别之Sha1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
              &nbsp; | &nbsp;
              <span class="page-pv"><i class="fa fa-file-o"></i>
              <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
              </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>又打了几天鱼晒了几天终于干了点什么，记录一下。<br><a id="more"></a><br>废了。</p>
<h2 id="SHA1算法简介"><a href="#SHA1算法简介" class="headerlink" title="SHA1算法简介"></a>SHA1算法简介</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>安全哈希算法（Secure Hash Algorithm）主要适用于数字签名标准（Digital Signature Standard DSS）里面定义的数字签名算法（Digital Signature Algorithm DSA）。对于长度小于2^64位的消息，SHA1会产生一个160位的消息摘要。当接收到消息的时候，这个消息摘要可以用来验证数据的完整性。在传输的过程中，数据很可能会发生变化，那么这时候就会产生不同的消息摘要。</p>
<p>SHA1有如下特性：不可以从消息摘要中复原信息；两个不同的消息不会产生同样的消息摘要。</p>
<h3 id="术语和概念"><a href="#术语和概念" class="headerlink" title="术语和概念"></a>术语和概念</h3><h4 id="位-Bit-，字节（Byte）和字（Word）"><a href="#位-Bit-，字节（Byte）和字（Word）" class="headerlink" title="位(Bit)，字节（Byte）和字（Word）"></a>位(Bit)，字节（Byte）和字（Word）</h4><p>SHA1始终把消息当成一个位（bit）字符串来处理。本文中，一个“字”（Word）是32位，而一个“字节”（Byte）是8位。比如，字符串“abc”可以被转换成一个位字符串：01100001 01100010 01100011。它也可以被表示成16进制字符串: 0x616263.</p>
<h4 id="运算符和符号"><a href="#运算符和符号" class="headerlink" title="运算符和符号"></a>运算符和符号</h4><p>下面的逻辑运算符都被运用于“字”（Word）</p>
<p>X^Y    = X， Y逻辑与</p>
<p>X // Y   = X， Y逻辑或</p>
<p>X XOR Y= X， Y逻辑异或</p>
<p>~X     =   X逻辑取反</p>
<p>X+Y定义如下：</p>
<p>字 X 和 Y 代表两个整数 x 和y, 其中 0 &lt;= x &lt; 2^32 且 0 &lt;= y &lt; 2^32. 令整数z = (x + y) mod 2^32. 这时候 0 &lt;= z &lt; 2^32. 将z转换成字Z, 那么就是 Z = X + Y.</p>
<p>循环左移位操作符Sn(X)。X是一个字，n是一个整数，0&lt;=n&lt;=32。Sn(X) = (X&lt;<n)or(x>&gt;32-n)</n)or(x></p>
<p>X&lt;<n定义如下：抛弃最左边的n位数字，将各个位依次向左移动n位，然后用0填补右边的n位（最后结果还是32位）。x>&gt;n是抛弃右边的n位，将各个位依次向右移动n位，然后在左边的n位填0。因此可以叫Sn(X)位循环移位运算</n定义如下：抛弃最左边的n位数字，将各个位依次向左移动n位，然后用0填补右边的n位（最后结果还是32位）。x></p>
<h3 id="SHA1算法描述"><a href="#SHA1算法描述" class="headerlink" title="SHA1算法描述"></a>SHA1算法描述</h3><p>在SHA1算法中，我们必须把原始消息（字符串，文件等）转换成位字符串。SHA1算法只接受位作为输入。假设我们对字符串“abc”产生消息摘要。首先，我们将它转换成位字符串如下：</p>
<p>01100001 01100010 01100011</p>
<p>―――――――――――――</p>
<p>‘a’=97   ‘b’=98   ‘c’=99</p>
<p>这个位字符串的长度为24。下面我们需要5个步骤来计算MD5。</p>
<h4 id="补位"><a href="#补位" class="headerlink" title="补位"></a>补位</h4><p>消息必须进行补位，以使其长度在对512取模以后的余数是448。也就是说，（补位后的消息长度）%512 = 448。即使长度已经满足对512取模后余数是448，补位也必须要进行。</p>
<p>补位是这样进行的：先补一个1，然后再补0，直到长度满足对512取模后余数是448。总而言之，补位是至少补一位，最多补512位。还是以前面的“abc”为例显示补位的过程。</p>
<p>原始信息： 01100001 01100010 01100011</p>
<p>补位第一步：01100001 01100010 01100011 1</p>
<p>首先补一个“1”</p>
<p>补位第二步：01100001 01100010 01100011 10…..0</p>
<p>然后补423个“0”</p>
<p>我们可以把最后补位完成后的数据用16进制写成下面的样子</p>
<p>61626380 00000000 00000000 00000000</p>
<p>00000000 00000000 00000000 00000000</p>
<p>00000000 00000000 00000000 00000000</p>
<p>00000000 00000000</p>
<p>现在，数据的长度是448了，我们可以进行下一步操作。</p>
<h4 id="补长度"><a href="#补长度" class="headerlink" title="补长度"></a>补长度</h4><p>所谓的补长度是将原始数据的长度补到已经进行了补位操作的消息后面。通常用一个64位的数据来表示原始消息的长度。如果消息长度不大于2^64，那么第一个字就是0。在进行了补长度的操作以后，整个消息就变成下面这样了（16进制格式）</p>
<p>61626380 00000000 00000000 00000000</p>
<p>00000000 00000000 00000000 00000000</p>
<p>00000000 00000000 00000000 00000000</p>
<p>00000000 00000000 00000000 00000018</p>
<p>如果原始的消息长度超过了512，我们需要将它补成512的倍数。然后我们把整个消息分成一个一个512位的数据块，分别处理每一个数据块，从而得到消息摘要。</p>
<h4 id="使用的常量"><a href="#使用的常量" class="headerlink" title="使用的常量"></a>使用的常量</h4><p>一系列的常量字K(0), K(1), … , K(79)，如果以16进制给出。它们如下：</p>
<p>Kt = 0x5A827999  (0 &lt;= t &lt;= 19)</p>
<p>Kt = 0x6ED9EBA1 (20 &lt;= t &lt;= 39)</p>
<p>Kt = 0x8F1BBCDC (40 &lt;= t &lt;= 59)</p>
<p>Kt = 0xCA62C1D6 (60 &lt;= t &lt;= 79).</p>
<p>需要使用的函数</p>
<p>在SHA1中我们需要一系列的函数。每个函数ft (0 &lt;= t &lt;= 79)都操作32位字B，C，D并且产生32位字作为输出。ft(B,C,D)可以如下定义</p>
<p>ft(B,C,D) = (B AND C) or ((NOT B) AND D) ( 0 &lt;= t &lt;= 19)</p>
<p>ft(B,C,D) = B XOR C XOR D             (20 &lt;= t &lt;= 39)</p>
<p>ft(B,C,D) = (B AND C) or (B AND D) or (C AND D) (40 &lt;= t &lt;= 59)</p>
<p>ft(B,C,D) = B XOR C XOR D                    (60 &lt;= t &lt;= 79).</p>
<p>计算消息摘要</p>
<p>必须使用进行了补位和补长度后的消息来计算消息摘要。计算需要两个缓冲区，每个都由5个32位的字组成，还需要一个80个32位字的缓冲区。第一个5个字的缓冲区被标识为A，B，C，D，E。第一个5个字的缓冲区被标识为H0, H1, H2, H3, H4</p>
<p>。80个字的缓冲区被标识为W0, W1,…, W79</p>
<p>另外还需要一个一个字的TEMP缓冲区。</p>
<p>为了产生消息摘要，在第4部分中定义的16个字的数据块M1, M2,…, Mn</p>
<p>会依次进行处理，处理每个数据块Mi 包含80个步骤。</p>
<p>在处理每个数据块之前，缓冲区{Hi} 被初始化为下面的值（16进制）</p>
<p>H0 = 0x67452301</p>
<p>H1 = 0xEFCDAB89</p>
<p>H2 = 0x98BADCFE</p>
<p>H3 = 0x10325476</p>
<p>H4 = 0xC3D2E1F0.<br>现在开始处理M1, M2, … , Mn。为了处理 Mi,需要进行下面的步骤</p>
<p>(1). 将 Mi 分成 16 个字 W0, W1, … , W15,  W0 是最左边的字</p>
<p>(2). 对于 t = 16 到 79 令 Wt = S1(Wt-3 XOR Wt-8 XOR Wt- 14 XOR Wt-16).</p>
<p>(3). 令 A = H0, B = H1, C = H2, D = H3, E = H4.</p>
<p>(4) 对于 t = 0 到 79，执行下面的循环</p>
<p>TEMP = S5(A) + ft(B,C,D) + E + Wt + Kt;</p>
<p>E = D; D = C; C = S30(B); B = A; A = TEMP;</p>
<p>(5). 令 H0 = H0 + A, H1 = H1 + B, H2 = H2 + C, H3 = H3 + D, H4 = H4 + E.<br>在处理完所有的 Mn, 后，消息摘要是一个160位的字符串，以下面的顺序标识</p>
<p>H0 H1 H2 H3 H4.</p>
<p>对于SHA256,SHA384,SHA512。你也可以用相似的办法来计算消息摘要。对消息进行补位的算法完全是一样的。</p>
<h3 id="实例分析"><a href="#实例分析" class="headerlink" title="实例分析"></a>实例分析</h3><p>例子很简单直接GetWindowTextA断点回溯即可找到验证函数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div></pre></td><td class="code"><pre><div class="line">004014A4  |.  68 C9000000   push 0xC9                                ; /Count = C9 (201.)</div><div class="line">004014A9  |.  895424 40     mov dword ptr ss:[esp+0x40],edx          ; |</div><div class="line">004014AD  |.  66:8B15 5C604&gt;mov dx,word ptr ds:[0x40605C]            ; |</div><div class="line">004014B4  |.  51            push ecx                                 ; |Buffer = 0019F5D4</div><div class="line">004014B5  |.  66:894424 2D  mov word ptr ss:[esp+0x2D],ax            ; |</div><div class="line">004014BA  |.  68 E8030000   push 0x3E8                               ; |ControlID = 3E8 (1000.)</div><div class="line">004014BF  |.  55            push ebp                                 ; |hWnd = 00030A82 (&apos;SHA1 *KeyGenMe*&apos;,class=&apos;#32770&apos;)</div><div class="line">004014C0  |.  66:895424 40  mov word ptr ss:[esp+0x40],dx            ; |</div><div class="line">004014C5  |.  885C24 20     mov byte ptr ss:[esp+0x20],bl            ; |</div><div class="line">004014C9  |.  884424 37     mov byte ptr ss:[esp+0x37],al            ; |</div><div class="line">004014CD  |.  FFD7          call edi                                 ; \GetDlgItemTextA</div><div class="line">004014CF  |.  8BF0          mov esi,eax                              ;  取用户名</div><div class="line">004014D1  |.  3BF3          cmp esi,ebx                              ;  user32.wsprintfA</div><div class="line">004014D3  |.  0F84 11010000 je SHA1KeyG.004015EA</div><div class="line">004014D9  |.  8D9424 980200&gt;lea edx,dword ptr ss:[esp+0x298]</div><div class="line">004014E0  |.  68 C9000000   push 0xC9                                ; /Count = C9 (201.)</div><div class="line">004014E5  |.  52            push edx                                 ; |Buffer = 0019F34C</div><div class="line">004014E6  |.  68 E9030000   push 0x3E9                               ; |ControlID = 3E9 (1001.)</div><div class="line">004014EB  |.  55            push ebp                                 ; |hWnd = 00030A82 (&apos;SHA1 *KeyGenMe*&apos;,class=&apos;#32770&apos;)</div><div class="line">004014EC  |.  FFD7          call edi                                 ; \GetDlgItemTextA</div><div class="line">004014EE  |.  83F8 14       cmp eax,0x14                             ;  取key，长度要为0x14</div><div class="line">004014F1  |.  0F85 F3000000 jnz SHA1KeyG.004015EA</div><div class="line">004014F7  |.  8D8424 600300&gt;lea eax,dword ptr ss:[esp+0x360]</div><div class="line">004014FE  |.  50            push eax</div><div class="line">004014FF  |.  E8 FCFAFFFF   call SHA1KeyG.00401000                   ;  Sha1Init</div><div class="line">00401504  |.  83C4 04       add esp,0x4</div><div class="line">00401507  |.  33FF          xor edi,edi</div><div class="line">00401509  |.  3BF3          cmp esi,ebx                              ;  user32.wsprintfA</div><div class="line">0040150B  |.  7E 1E         jle short SHA1KeyG.0040152B</div><div class="line">0040150D  |&gt;  0FBE8C3C D001&gt;/movsx ecx,byte ptr ss:[esp+edi+0x1D0]   ;  取用户名</div><div class="line">00401515  |.  8D9424 600300&gt;|lea edx,dword ptr ss:[esp+0x360]</div><div class="line">0040151C  |.  51            |push ecx</div><div class="line">0040151D  |.  52            |push edx</div><div class="line">0040151E  |.  E8 1DFBFFFF   |call SHA1KeyG.00401040                  ;  消息填充</div><div class="line">00401523  |.  83C4 08       |add esp,0x8</div><div class="line">00401526  |.  47            |inc edi</div><div class="line">00401527  |.  3BFE          |cmp edi,esi</div><div class="line">00401529  |.^ 7C E2         \jl short SHA1KeyG.0040150D</div><div class="line">0040152B  |&gt;  8D8424 080100&gt;lea eax,dword ptr ss:[esp+0x108]</div><div class="line">00401532  |.  8D8C24 600300&gt;lea ecx,dword ptr ss:[esp+0x360]</div><div class="line">00401539  |.  50            push eax</div><div class="line">0040153A  |.  51            push ecx</div><div class="line">0040153B  |.  E8 60FDFFFF   call SHA1KeyG.004012A0                   ;  Sha1End</div><div class="line">00401540  |.  83C4 08       add esp,0x8</div><div class="line">00401543  |.  33C0          xor eax,eax</div><div class="line">00401545  |&gt;  8A5404 34     /mov dl,byte ptr ss:[esp+eax+0x34]       ;  pediy forum</div><div class="line">00401549  |.  8A8C04 080100&gt;|mov cl,byte ptr ss:[esp+eax+0x108]      ;  sha1值</div><div class="line">00401550  |.  32D1          |xor dl,cl                               ;  xor</div><div class="line">00401552  |.  885404 40     |mov byte ptr ss:[esp+eax+0x40],dl       ;  endbuf</div><div class="line">00401556  |.  40            |inc eax</div><div class="line">00401557  |.  83F8 11       |cmp eax,0x11</div><div class="line">0040155A  |.^ 7C E9         \jl short SHA1KeyG.00401545</div><div class="line">0040155C  |.  83F8 14       cmp eax,0x14</div><div class="line">0040155F  |.  7D 1B         jge short SHA1KeyG.0040157C</div><div class="line">00401561  |.  8D4C24 28     lea ecx,dword ptr ss:[esp+0x28]          ;  pediy.com</div><div class="line">00401565  |.  83E9 11       sub ecx,0x11</div><div class="line">00401568  |&gt;  8A1401        /mov dl,byte ptr ds:[ecx+eax]</div><div class="line">0040156B  |.  329404 080100&gt;|xor dl,byte ptr ss:[esp+eax+0x108]      ;  异或后三字节</div><div class="line">00401572  |.  40            |inc eax</div><div class="line">00401573  |.  83F8 14       |cmp eax,0x14</div><div class="line">00401576  |.  885404 3F     |mov byte ptr ss:[esp+eax+0x3F],dl</div><div class="line">0040157A  |.^ 7C EC         \jl short SHA1KeyG.00401568</div><div class="line">0040157C  |&gt;  8B1D A4504000 mov ebx,dword ptr ds:[&lt;&amp;USER32.wsprintfA&gt;;  user32.wsprintfA</div><div class="line">00401582  |.  33F6          xor esi,esi</div><div class="line">00401584  |.  8D7C24 10     lea edi,dword ptr ss:[esp+0x10]</div><div class="line">00401588  |&gt;  8A4434 4A     /mov al,byte ptr ss:[esp+esi+0x4A]</div><div class="line">0040158C  |.  8A4C34 40     |mov cl,byte ptr ss:[esp+esi+0x40]</div><div class="line">00401590  |.  32C8          |xor cl,al                               ;  十字节异或</div><div class="line">00401592  |.  8AC1          |mov al,cl</div><div class="line">00401594  |.  884C34 40     |mov byte ptr ss:[esp+esi+0x40],cl       ;  endbuf</div><div class="line">00401598  |.  25 FF000000   |and eax,0xFF</div><div class="line">0040159D  |.  50            |push eax</div><div class="line">0040159E  |.  68 4C604000   |push SHA1KeyG.0040604C                  ;  ASCII &quot;%02X&quot;</div><div class="line">004015A3  |.  57            |push edi</div><div class="line">004015A4  |.  FFD3          |call ebx                                ;  user32.wsprintfA</div><div class="line">004015A6  |.  83C4 0C       |add esp,0xC</div><div class="line">004015A9  |.  46            |inc esi</div><div class="line">004015AA  |.  83C7 02       |add edi,0x2</div><div class="line">004015AD  |.  83FE 0A       |cmp esi,0xA</div><div class="line">004015B0  |.^ 7C D6         \jl short SHA1KeyG.00401588</div><div class="line">004015B2  |.  8D8C24 980200&gt;lea ecx,dword ptr ss:[esp+0x298]</div><div class="line">004015B9  |.  8D5424 10     lea edx,dword ptr ss:[esp+0x10]</div><div class="line">004015BD  |.  51            push ecx                                 ; /String2 = &quot;1234567890abcdefghij&quot;</div><div class="line">004015BE  |.  52            push edx                                 ; |String1 = &quot;F24CB1C3CDAE9D0F970D&quot;</div><div class="line">004015BF  |.  FF15 00504000 call dword ptr ds:[&lt;&amp;KERNEL32.lstrcmpA&gt;] ; \lstrcmpA</div><div class="line">004015C5  |.  85C0          test eax,eax</div><div class="line">004015C7  |.  75 21         jnz short SHA1KeyG.004015EA</div><div class="line">004015C9  |.  68 40604000   push SHA1KeyG.00406040                   ; /Text = &quot;Success!&quot;</div><div class="line">004015CE  |.  68 E9030000   push 0x3E9                               ; |ControlID = 3E9 (1001.)</div><div class="line">004015D3  |.  55            push ebp                                 ; |hWnd = 00030A82 (&apos;SHA1 *KeyGenMe*&apos;,class=&apos;#32770&apos;)</div><div class="line">004015D4  |.  FF15 A8504000 call dword ptr ds:[&lt;&amp;USER32.SetDlgItemTe&gt;; \SetDlgItemTextA</div><div class="line">004015DA  |.  5F            pop edi                                  ;  0019F34C</div><div class="line">004015DB  |.  5E            pop esi                                  ;  0019F34C</div><div class="line">004015DC  |.  5D            pop ebp                                  ;  0019F34C</div><div class="line">004015DD  |.  B8 01000000   mov eax,0x1</div><div class="line">004015E2  |.  5B            pop ebx                                  ;  0019F34C</div><div class="line">004015E3  |.  81C4 B8040000 add esp,0x4B8</div><div class="line">004015E9  |.  C3            retn</div><div class="line">004015EA  |&gt;  68 30604000   push SHA1KeyG.00406030                   ; /Text = &quot;Wrong Serial!&quot;</div><div class="line">004015EF  |.  68 E9030000   push 0x3E9                               ; |ControlID = 3E9 (1001.)</div><div class="line">004015F4  |.  55            push ebp                                 ; |hWnd = 00030A82 (&apos;SHA1 *KeyGenMe*&apos;,class=&apos;#32770&apos;)</div><div class="line">004015F5  |.  FF15 A8504000 call dword ptr ds:[&lt;&amp;USER32.SetDlgItemTe&gt;; \SetDlgItemTextA</div><div class="line">004015FB  |.  5F            pop edi                                  ;  0019F34C</div><div class="line">004015FC  |.  5E            pop esi                                  ;  0019F34C</div><div class="line">004015FD  |.  5D            pop ebp                                  ;  0019F34C</div><div class="line">004015FE  |.  33C0          xor eax,eax</div><div class="line">00401600  |.  5B            pop ebx                                  ;  0019F34C</div><div class="line">00401601  |.  81C4 B8040000 add esp,0x4B8</div><div class="line">00401607  \.  C3            retn</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Sha1Init</div><div class="line">00401000  /$  8B5424 04     mov edx,dword ptr ss:[esp+0x4]</div><div class="line">00401004  |.  57            push edi                                 ;  user32.GetDlgItemTextA</div><div class="line">00401005  |.  B9 50000000   mov ecx,0x50</div><div class="line">0040100A  |.  33C0          xor eax,eax</div><div class="line">0040100C  |.  8D7A 28       lea edi,dword ptr ds:[edx+0x28]</div><div class="line">0040100F  |.  F3:AB         rep stos dword ptr es:[edi]</div><div class="line">00401011  |.  8942 04       mov dword ptr ds:[edx+0x4],eax</div><div class="line">00401014  |.  8902          mov dword ptr ds:[edx],eax</div><div class="line">00401016  |.  C742 08 01234&gt;mov dword ptr ds:[edx+0x8],0x67452301</div><div class="line">0040101D  |.  C742 0C 89ABC&gt;mov dword ptr ds:[edx+0xC],0xEFCDAB89</div><div class="line">00401024  |.  C742 10 FEDCB&gt;mov dword ptr ds:[edx+0x10],0x98BADCFE</div><div class="line">0040102B  |.  C742 14 76543&gt;mov dword ptr ds:[edx+0x14],0x10325476</div><div class="line">00401032  |.  C742 18 F0E1D&gt;mov dword ptr ds:[edx+0x18],0xC3D2E1F0</div><div class="line">00401039  |.  5F            pop edi                                  ;  0019F69C</div><div class="line">0040103A  \.  C3            retn</div></pre></td></tr></table></figure></p>
<p>Sha1初始化后内存数据</p>
<p>进行消息填充后内存数据</p>
<p>以上就是分析流程，根据这就能写出注册机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div></pre></td><td class="code"><pre><div class="line">#include &quot;stdafx.h&quot;</div><div class="line">#include &lt;string.h&gt;</div><div class="line">typedef struct &#123;</div><div class="line">    unsigned int length[2];</div><div class="line">    unsigned int h[8];</div><div class="line">    unsigned int w[80];</div><div class="line">&#125; sha;</div><div class="line"></div><div class="line">#define H0 0x67452301L</div><div class="line">#define H1 0xefcdab89L</div><div class="line">#define H2 0x98badcfeL</div><div class="line">#define H3 0x10325476L</div><div class="line">#define H4 0xc3d2e1f0L</div><div class="line"></div><div class="line">#define K0 0x5a827999L</div><div class="line">#define K1 0x6ed9eba1L</div><div class="line">#define K2 0x8f1bbcdcL</div><div class="line">#define K3 0xca62c1d6L</div><div class="line"></div><div class="line">#define PAD  0x80</div><div class="line">#define ZERO 0</div><div class="line"></div><div class="line">/* functions */</div><div class="line"></div><div class="line">#define S(n,x) (((x)&lt;&lt;n) | ((x)&gt;&gt;(32-n)))</div><div class="line"></div><div class="line">#define F0(x,y,z) ((x&amp;y)|((~x)&amp;z))</div><div class="line">#define F1(x,y,z) (x^y^z)</div><div class="line">#define F2(x,y,z) ((x&amp;y) | (x&amp;z)|(y&amp;z)) </div><div class="line">#define F3(x,y,z) (x^y^z)</div><div class="line"></div><div class="line">static void sha1_transform(sha *sh)</div><div class="line">&#123; /* basic transformation step */</div><div class="line">    unsigned int a, b, c, d, e, temp;</div><div class="line">    int t;</div><div class="line"></div><div class="line">    for (t = 16; t &lt; 80; t++) sh-&gt;w[t] = S(1, sh-&gt;w[t - 3] ^ sh-&gt;w[t - 8] ^ sh-&gt;w[t - 14] ^ sh-&gt;w[t - 16]);</div><div class="line">    a = sh-&gt;h[0]; b = sh-&gt;h[1]; c = sh-&gt;h[2]; d = sh-&gt;h[3]; e = sh-&gt;h[4];</div><div class="line">    for (t = 0; t &lt; 20; t++)</div><div class="line">    &#123; /* 20 times - mush it up */</div><div class="line">        temp = K0 + F0(b, c, d) + S(5, a) + e + sh-&gt;w[t];</div><div class="line">        e = d; d = c;</div><div class="line">        c = S(30, b);</div><div class="line">        b = a; a = temp;</div><div class="line">    &#125;</div><div class="line">    for (t = 20; t &lt; 40; t++)</div><div class="line">    &#123; /* 20 more times - mush it up */</div><div class="line">        temp = K1 + F1(b, c, d) + S(5, a) + e + sh-&gt;w[t];</div><div class="line">        e = d; d = c;</div><div class="line">        c = S(30, b);</div><div class="line">        b = a; a = temp;</div><div class="line">    &#125;</div><div class="line">    for (t = 40; t &lt; 60; t++)</div><div class="line">    &#123; /* 20 more times - mush it up */</div><div class="line">        temp = K2 + F2(b, c, d) + S(5, a) + e + sh-&gt;w[t];</div><div class="line">        e = d; d = c;</div><div class="line">        c = S(30, b);</div><div class="line">        b = a; a = temp;</div><div class="line">    &#125;</div><div class="line">    for (t = 60; t &lt; 80; t++)</div><div class="line">    &#123; /* 20 more times - mush it up */</div><div class="line">        temp = K3 + F3(b, c, d) + S(5, a) + e + sh-&gt;w[t];</div><div class="line">        e = d; d = c;</div><div class="line">        c = S(30, b);</div><div class="line">        b = a; a = temp;</div><div class="line">    &#125;</div><div class="line">    sh-&gt;h[0] += a; sh-&gt;h[1] += b; sh-&gt;h[2] += c;</div><div class="line">    sh-&gt;h[3] += d; sh-&gt;h[4] += e;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void sha1_init(sha *sh)</div><div class="line">&#123; /* re-initialise */</div><div class="line">    int i;</div><div class="line"></div><div class="line">    for (i = 0; i &lt; 80; i++) sh-&gt;w[i] = 0L;</div><div class="line">    sh-&gt;length[0] = sh-&gt;length[1] = 0L;</div><div class="line"></div><div class="line">    sh-&gt;h[0] = H0;</div><div class="line">    sh-&gt;h[1] = H1;</div><div class="line">    sh-&gt;h[2] = H2;</div><div class="line">    sh-&gt;h[3] = H3;</div><div class="line">    sh-&gt;h[4] = H4;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void sha1_process(sha *sh, int byte)</div><div class="line">&#123; /* process the next message byte */</div><div class="line">    int cnt;</div><div class="line"></div><div class="line">    cnt = (int)((sh-&gt;length[0] / 32) % 16);</div><div class="line"></div><div class="line">    sh-&gt;w[cnt] &lt;&lt;= 8;</div><div class="line">    sh-&gt;w[cnt] |= (unsigned int)(byte &amp; 0xFF);</div><div class="line"></div><div class="line">    sh-&gt;length[0] += 8;</div><div class="line">    if (sh-&gt;length[0] == 0L) &#123; sh-&gt;length[1]++; sh-&gt;length[0] = 0L; &#125;</div><div class="line">    if ((sh-&gt;length[0] % 512) == 0) sha1_transform(sh);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void sha1_hash(sha *sh, char hash[20])</div><div class="line">&#123; /* pad message and finish - supply digest */</div><div class="line">    int i;</div><div class="line">    unsigned int len0, len1;</div><div class="line">    len0 = sh-&gt;length[0];</div><div class="line">    len1 = sh-&gt;length[1];</div><div class="line">    sha1_process(sh, PAD);</div><div class="line">    while ((sh-&gt;length[0] % 512) != 448) sha1_process(sh, ZERO);</div><div class="line">    sh-&gt;w[14] = len1;</div><div class="line">    sh-&gt;w[15] = len0;</div><div class="line">    sha1_transform(sh);</div><div class="line">    for (i = 0; i &lt; 20; i++)</div><div class="line">    &#123; /* convert to bytes */</div><div class="line">        hash[i] = ((sh-&gt;h[i / 4] &gt;&gt; (8 * (3 - i % 4))) &amp; 0xffL);</div><div class="line">    &#125;</div><div class="line">    sha1_init(sh);</div><div class="line">&#125;</div><div class="line"></div><div class="line">int _tmain(int argc, _TCHAR* argv[])</div><div class="line">&#123;</div><div class="line">    sha sh;</div><div class="line">    sha1_init(&amp;sh);</div><div class="line">    char *strName = &quot;abcde&quot; ;</div><div class="line">    for (int i = 0; i &lt; strlen(strName); i++)</div><div class="line">    &#123;</div><div class="line">        sha1_process(&amp;sh, strName[i]);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    char strRes[0x20] = &#123; 0 &#125;;</div><div class="line">    sha1_hash(&amp;sh, strRes);</div><div class="line"></div><div class="line">    char *str1 = &quot;PEDIY Forum&quot;;</div><div class="line">    char strEnd[0x20] = &#123; 0 &#125;;</div><div class="line">    int i = 0;</div><div class="line">    for (i = 0; i &lt; 17; i++)</div><div class="line">    &#123;</div><div class="line">        strEnd[i] = strRes[i] ^ str1[i];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    char *str2 = &quot;pediy.com&quot;;</div><div class="line">    for (; i &lt; 0x14;i++)</div><div class="line">    &#123;</div><div class="line">        strEnd[i] = str2[i] ^ strRes[i - 0x11];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    for (i = 0; i &lt; 0xa; i++)</div><div class="line">    &#123;</div><div class="line">        strEnd[i] ^= strEnd[i + 0xa];</div><div class="line">    &#125;</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>总结一下识别Sha1的关键特征：<br>1）五个初始化的常量0x67452301,0xEFCDAB89,0x98BADCFE,0x10325476,0xC3D2E1F0</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/算法/" rel="tag">#算法</a>
          
            <a href="/tags/逆向/" rel="tag">#逆向</a>
          
            <a href="/tags/密码/" rel="tag">#密码</a>
          
            <a href="/tags/Sha1/" rel="tag">#Sha1</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/13/华为机顶盒破解。/" rel="next" title="华为机顶盒破解。">
                <i class="fa fa-chevron-left"></i> 华为机顶盒破解。
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/16/Crc32识别。/" rel="prev" title="Crc32识别。">
                Crc32识别。 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/12/15/算法识别之Sha1/"
           data-title="算法识别之Sha1" data-url="http://blog.injectxx.com/2016/12/15/算法识别之Sha1/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="岁月。" />
          <p class="site-author-name" itemprop="name">岁月。</p>
          <p class="site-description motion-element" itemprop="description">志之所向，金石为开，谁能御之？</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">26</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Kernel32Sun" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://weibo.com" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:s.allure.love@gmail.com" target="_blank" title="Email">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                  Email
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              小伙伴儿
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.injectxx.com/" title="岁月's Blog" target="_blank">岁月's Blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.wangzhixian.org/" title="wnagzihxain’s Blog" target="_blank">wnagzihxain’s Blog</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#SHA1算法简介"><span class="nav-number">1.</span> <span class="nav-text">SHA1算法简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介"><span class="nav-number">1.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#术语和概念"><span class="nav-number">1.2.</span> <span class="nav-text">术语和概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#位-Bit-，字节（Byte）和字（Word）"><span class="nav-number">1.2.1.</span> <span class="nav-text">位(Bit)，字节（Byte）和字（Word）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#运算符和符号"><span class="nav-number">1.2.2.</span> <span class="nav-text">运算符和符号</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHA1算法描述"><span class="nav-number">1.3.</span> <span class="nav-text">SHA1算法描述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#补位"><span class="nav-number">1.3.1.</span> <span class="nav-text">补位</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#补长度"><span class="nav-number">1.3.2.</span> <span class="nav-text">补长度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用的常量"><span class="nav-number">1.3.3.</span> <span class="nav-text">使用的常量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实例分析"><span class="nav-number">1.4.</span> <span class="nav-text">实例分析</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>


<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">岁月。</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"kernel32sun"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  
<script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js">
</script>


</body>
</html>
